name: Testimonial creation
  
on:
  issues:
    types: [opened]

jobs:
  check-label:
    runs-on: ubuntu-latest
    name: Check Testimonial Label
    steps:
      - uses: renanmav/match-label-action@v3
        with:
          allowed: >
            testimonial
      - name: Validate label
        if: steps.label.outputs.match == 'testimonial'
        run: echo "Issue has the testimonial label"
  create-file:
    runs-on: ubuntu-latest
    name: Create Testimonial File and Commit it
    needs: [check-label]
    steps:
      - uses: actions/checkout@v3
      - uses: peter-murray/issue-forms-body-parser@v2.0.0
        with:
          issue_id: ${{ github.event.issue.number }}
      - name: Show parsed data JSON
        run: |
          echo "${{ steps.parse.outputs.payload }}"
      - name: Create folder
        run: |
          mkdir -p data/test
      - uses: finnp/create-file-action@master
        env:
          FILE_NAME: "data/test/test-user.json"
          FILE_DATA: '{"title": "Testimonial title", "description": "testimonial description", "date": "2022-26-11"}'
      - name: Setup Git config
        run: |
          # setup the username and email. I tend to use 'GitHub Actions Bot' with no email by default
          git config user.name "GitHub Actions Bot"
          git config user.email "<>"
      - name: Commit
        run: |
          # setup the username and email. I tend to use 'GitHub Actions Bot' with no email by default
          git add --all
          git commit -m "New testimonial"
          git push origin main
      

     
          


